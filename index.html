<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>VocalForge Pro - Smart Studio</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0f172a; 
            background-image: radial-gradient(at 50% 0%, #1e293b 0%, #0f172a 70%);
            color: #f1f5f9;
            -webkit-tap-highlight-color: transparent;
        }

        .glass-panel {
            background: rgba(30, 41, 59, 0.7);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 20px;
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.3);
        }

        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 10px; }

        select, input, textarea {
            background-color: rgba(15, 23, 42, 0.6);
            border: 1px solid #334155;
            transition: all 0.2s ease;
        }
        select:focus, input:focus, textarea:focus {
            border-color: #38bdf8;
            background-color: rgba(15, 23, 42, 0.9);
            box-shadow: 0 0 0 2px rgba(56, 189, 248, 0.2);
            outline: none;
        }

        .tab-btn { position: relative; transition: all 0.3s; }
        .tab-btn.active { color: #38bdf8; background: rgba(56, 189, 248, 0.05); }
        .tab-btn::after {
            content: ''; position: absolute; bottom: 0; left: 50%; width: 0; height: 3px;
            background: #38bdf8; transition: all 0.3s; transform: translateX(-50%) scaleX(0); border-radius: 3px 3px 0 0;
        }
        .tab-btn.active::after { transform: translateX(-50%) scaleX(1); width: 60%; }

        input[type=range] { -webkit-appearance: none; width: 100%; background: transparent; }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none; height: 18px; width: 18px; border-radius: 50%;
            background: #38bdf8; cursor: pointer; margin-top: -7px; border: 2px solid #fff;
        }
        input[type=range]::-webkit-slider-runnable-track { width: 100%; height: 4px; background: #334155; border-radius: 2px; }

        .chat-row { display: flex; margin-bottom: 12px; align-items: flex-end; width: 100%; }
        .chat-row.speaker-a { justify-content: flex-start; }
        .chat-row.speaker-b { justify-content: flex-end; }
        .chat-bubble {
            max-width: 80%; padding: 10px 14px; border-radius: 16px; font-size: 0.9rem; line-height: 1.4; position: relative;
        }
        .chat-row.speaker-a .chat-bubble { background: #1e293b; border: 1px solid #334155; color: #e2e8f0; border-bottom-left-radius: 4px; }
        .chat-row.speaker-b .chat-bubble { background: linear-gradient(135deg, #0284c7, #0ea5e9); border: none; color: white; border-bottom-right-radius: 4px; }
        
        .delete-btn {
            position: absolute; top: -6px; right: -6px; width: 20px; height: 20px;
            background: #ef4444; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center;
            font-size: 10px; opacity: 0; transform: scale(0.8); transition: all 0.2s; cursor: pointer; z-index: 10;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3); border: 2px solid #0f172a;
        }
        .chat-bubble:hover .delete-btn { opacity: 1; transform: scale(1); }
        .playing-now { ring: 2px solid #fbbf24; transform: scale(1.02); transition: all 0.3s; }

        .loader { border: 3px solid rgba(255,255,255,0.3); border-top: 3px solid #fff; border-radius: 50%; width: 18px; height: 18px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .fade-in { animation: fadeIn 0.4s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        .bar { width: 6px; height: 12px; background: #38bdf8; border-radius: 4px; transition: height 0.1s; }
        .animating .bar { animation: bounce 0.6s infinite ease-in-out alternate; }
        .animating .bar:nth-child(1) { animation-delay: 0.0s; } .animating .bar:nth-child(2) { animation-delay: 0.1s; } .animating .bar:nth-child(3) { animation-delay: 0.2s; } .animating .bar:nth-child(4) { animation-delay: 0.3s; } .animating .bar:nth-child(5) { animation-delay: 0.4s; }
        @keyframes bounce { 0% { height: 12px; opacity: 0.5; } 100% { height: 32px; opacity: 1; background: #bae6fd; } }
    </style>
</head>
<body class="min-h-screen flex flex-col pb-safe">

    <nav class="border-b border-slate-700/50 bg-slate-900/80 sticky top-0 z-50 backdrop-blur-lg">
        <div class="max-w-4xl mx-auto px-4 sm:px-6">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center gap-3">
                    <img src="1000063032.png" onerror="this.onerror=null; this.src='https://cdn-icons-png.flaticon.com/512/4712/4712009.png';" alt="Logo" class="h-10 w-10 object-cover rounded-full bg-slate-800 border-2 border-slate-700">
                    <div>
                        <span class="font-bold text-lg tracking-tight text-white leading-none">VocalForge <span class="text-sky-400">Pro</span></span>
                        <span class="text-[10px] font-medium text-slate-400 tracking-wide uppercase">Lintas Nusa AI</span>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <main class="flex-grow p-4 md:p-6 max-w-4xl mx-auto w-full space-y-6">

        <!-- API Config -->
        <div id="ai-config" class="glass-panel p-5 relative overflow-hidden fade-in">
            <div class="absolute -top-12 -right-12 w-32 h-32 bg-sky-500/10 rounded-full blur-2xl pointer-events-none"></div>
            <label class="block text-xs font-bold text-sky-100 mb-3 flex items-center gap-2">
                <span class="bg-sky-500/20 text-sky-400 p-1.5 rounded-md"><i class="fa-brands fa-google"></i></span> CONFIG API
            </label>
            <div class="flex gap-0 rounded-xl border border-slate-600 focus-within:border-sky-500 focus-within:ring-1 focus-within:ring-sky-500 transition-all bg-slate-900/60 overflow-hidden shadow-inner">
                <div class="pl-3 pr-2 flex items-center justify-center bg-transparent"><i class="fa-solid fa-key text-slate-500 text-xs"></i></div>
                <input type="password" id="api-key" placeholder="Paste Gemini API Key here..." class="flex-grow bg-transparent border-none text-white text-sm px-2 py-3 focus:ring-0 placeholder-slate-500 outline-none w-full font-mono tracking-wide">
                <div class="w-px bg-slate-700 my-2"></div>
                <a href="https://aistudio.google.com/app/apikey" target="_blank" class="flex items-center px-4 bg-slate-800/50 hover:bg-slate-700 text-sky-400 text-xs font-bold transition-colors whitespace-nowrap">Get Key <i class="fa-solid fa-arrow-up-right-from-square ml-1.5 text-[10px]"></i></a>
            </div>
            <div class="mt-3 grid grid-cols-1 sm:grid-cols-2 gap-2">
                <div class="flex items-center gap-2 text-[10px] text-slate-400 bg-slate-800/40 px-3 py-2 rounded-lg border border-slate-700/30">
                    <span class="flex-shrink-0 w-4 h-4 rounded-full bg-slate-700 text-sky-400 flex items-center justify-center font-bold text-[9px]">1</span> Login Google AI Studio
                </div>
                <div class="flex items-center gap-2 text-[10px] text-slate-400 bg-slate-800/40 px-3 py-2 rounded-lg border border-slate-700/30">
                    <span class="flex-shrink-0 w-4 h-4 rounded-full bg-slate-700 text-sky-400 flex items-center justify-center font-bold text-[9px]">2</span> Create API Key & Copy
                </div>
            </div>
        </div>

        <!-- Mode Tabs -->
        <div class="bg-slate-800/40 p-1 rounded-xl flex border border-slate-700/50">
            <button onclick="switchTab('monologue')" id="tab-monologue" class="tab-btn active flex-1 py-3 text-sm font-semibold rounded-lg flex items-center justify-center gap-2">
                <i class="fa-solid fa-microphone-lines"></i> Monolog
            </button>
            <button onclick="switchTab('dialogue')" id="tab-dialogue" class="tab-btn flex-1 py-3 text-sm font-semibold rounded-lg flex items-center justify-center gap-2 text-slate-400 hover:text-slate-300">
                <i class="fa-solid fa-comments"></i> Dialog
            </button>
        </div>

        <!-- === MODE MONOLOG === -->
        <div id="monologue-section" class="space-y-5 fade-in">
            <div class="glass-panel p-5 space-y-4">
                <div class="flex justify-between items-center pb-3 border-b border-slate-700/50">
                    <label class="text-xs font-bold text-slate-300 uppercase tracking-wide">Mesin Suara</label>
                    <div class="flex bg-slate-900 rounded-lg p-1 border border-slate-700">
                        <button onclick="setEngine('standard')" id="btn-std" class="px-3 py-1.5 rounded-md text-[10px] font-bold text-slate-400 hover:text-white transition-all">HP (Offline)</button>
                        <button onclick="setEngine('ai')" id="btn-ai" class="px-3 py-1.5 rounded-md text-[10px] font-bold bg-sky-600 text-white shadow-md transition-all">Google AI</button>
                    </div>
                </div>
                <div class="relative">
                    <textarea id="text-input" class="w-full h-32 bg-slate-900/50 text-slate-200 border border-slate-600 rounded-xl p-4 text-sm focus:ring-2 focus:ring-sky-500/50 outline-none resize-none placeholder-slate-600" placeholder="Ketik naskah monolog..."></textarea>
                    <div class="absolute bottom-3 right-3 flex items-center gap-3">
                        <span id="charCount" class="text-[10px] text-slate-500 font-mono">0 chars</span>
                        <button onclick="clearText()" class="text-[10px] text-red-400 hover:text-red-300 transition-colors" title="Hapus"><i class="fa-solid fa-trash"></i></button>
                    </div>
                </div>
            </div>

            <div class="glass-panel p-5 space-y-5">
                <div class="space-y-1.5">
                    <label class="text-[10px] font-bold text-slate-400 uppercase tracking-wider ml-1">Voice Actor</label>
                    <div class="flex gap-2">
                        <div class="relative flex-grow">
                            <select id="voice-select" class="w-full h-11 pl-3 pr-8 rounded-xl bg-slate-800 border border-slate-600 text-white text-sm appearance-none focus:border-sky-500 cursor-pointer"></select>
                            <div class="absolute inset-y-0 right-0 flex items-center px-3 pointer-events-none text-slate-400"><i class="fa-solid fa-chevron-down text-xs"></i></div>
                        </div>
                        <button id="refresh-voices-btn" onclick="forceReloadVoices()" class="hidden w-11 h-11 bg-slate-800 hover:bg-slate-700 rounded-xl border border-slate-600 text-sky-400 flex-shrink-0 flex items-center justify-center transition-all" title="Refresh"><i class="fa-solid fa-rotate"></i></button>
                    </div>
                    <p id="voice-desc" class="text-[10px] text-sky-400 italic ml-1 hidden animate-pulse"></p>
                </div>

                <div id="ai-controls" class="space-y-4 pt-2">
                    <div class="grid grid-cols-2 gap-4">
                        <div class="space-y-1.5">
                            <label class="text-[10px] font-bold text-slate-400 uppercase">Bahasa</label>
                            <div class="relative">
                                <select id="ai-language-select" class="w-full h-10 pl-3 pr-8 rounded-lg bg-slate-800 border border-slate-600 text-white text-xs appearance-none">
                                    <option value="Indonesian">ğŸ‡®ğŸ‡© Indonesia</option><option value="Javanese">ğŸ‡®ğŸ‡© Jawa</option><option value="Sundanese">ğŸ‡®ğŸ‡© Sunda</option>
                                    <option value="English">ğŸ‡ºğŸ‡¸ English</option><option value="Japanese">ğŸ‡¯ğŸ‡µ Japanese</option><option value="Korean">ğŸ‡°ğŸ‡· Korean</option><option value="Chinese">ğŸ‡¨ğŸ‡³ Chinese</option>
                                </select>
                                <div class="absolute right-2 top-2.5 text-slate-400 pointer-events-none"><i class="fa-solid fa-chevron-down text-[10px]"></i></div>
                            </div>
                        </div>
                        <div class="space-y-1.5">
                            <label class="text-[10px] font-bold text-slate-400 uppercase">Modifikasi</label>
                            <div class="relative">
                                <select id="voice-mod-select" class="w-full h-10 pl-3 pr-8 rounded-lg bg-slate-800 border border-slate-600 text-white text-xs appearance-none">
                                    <option value="">Normal</option><option value="deep">ğŸ”‰ Berat</option><option value="high">ğŸ”Š Tinggi</option><option value="slow">ğŸ¢ Lambat</option><option value="fast">ğŸ‡ Cepat</option>
                                </select>
                                <div class="absolute right-2 top-2.5 text-slate-400 pointer-events-none"><i class="fa-solid fa-chevron-down text-[10px]"></i></div>
                            </div>
                        </div>
                    </div>

                    <div class="space-y-1.5">
                        <label class="text-[10px] font-bold text-slate-400 uppercase">Karakter & Emosi</label>
                        <div class="relative">
                            <select id="style-select" class="w-full h-11 pl-3 pr-8 rounded-xl bg-slate-800 border border-slate-600 text-white text-sm appearance-none cursor-pointer">
                                <option value="normal">Normal</option>
                                <optgroup label="Emosi"><option value="cheerfully">ğŸ˜„ Ceria</option><option value="sadly">ğŸ˜¢ Sedih</option><option value="excitedly">ğŸ”¥ Hype</option><option value="angrily">ğŸ˜¡ Marah</option><option value="whisper">ğŸ¤« Bisik</option></optgroup>
                                <optgroup label="Drama"><option value="melodramatic">ğŸ­ Melodramatis</option><option value="heartbroken">ğŸ’” Patah Hati</option><option value="villain">ğŸ˜ˆ Antagonis</option><option value="inner_monologue">ğŸ’­ Suara Hati</option></optgroup>
                                <optgroup label="Kreator"><option value="podcaster">ğŸ™ï¸ Podcaster</option><option value="streamer">ğŸ® Streamer</option><option value="reviewer">ğŸ“± Reviewer</option><option value="motivator">ğŸŒŸ Motivator</option><option value="news">ğŸ“° Berita</option></optgroup>
                                <optgroup label="Fantasi"><option value="demon">ğŸ”¥ Demon</option><option value="knight">âš”ï¸ Knight</option><option value="princess">ğŸ‘‘ Princess</option><option value="monster">ğŸ‘¹ Monster</option><option value="ghost">ğŸ‘» Hantu</option><option value="robot">ğŸ¤– Robot</option></optgroup>
                                <option value="custom">-- Manual --</option>
                            </select>
                            <div class="absolute right-3 top-3.5 text-slate-400 pointer-events-none"><i class="fa-solid fa-chevron-down text-xs"></i></div>
                        </div>
                    </div>

                    <div id="context-container" class="space-y-1.5">
                        <label class="text-[10px] font-bold text-slate-400 uppercase">Konteks</label>
                        <div class="relative">
                            <select id="context-select" class="w-full h-11 pl-3 pr-8 rounded-xl bg-slate-800 border border-slate-600 text-white text-sm appearance-none cursor-pointer">
                                <option value="">-- Tidak Ada --</option>
                                <optgroup label="Konten"><option value="intro">ğŸ‘‹ Intro</option><option value="outro">ğŸ™ Outro</option><option value="unboxing">ğŸ“¦ Unboxing</option><option value="tutorial">ğŸ“š Tutorial</option><option value="promo">âš¡ Promo</option><option value="creepypasta">ğŸ‘» Horor</option></optgroup>
                                <optgroup label="Drama"><option value="soap_opera">ğŸ“º Sinetron</option><option value="breakup">ğŸ’” Putus</option><option value="dying">ğŸ’€ Sekarat</option><option value="battle_shout">âš”ï¸ Perang</option><option value="prank">ğŸ¤¡ Prank</option></optgroup>
                            </select>
                            <div class="absolute right-3 top-3.5 text-slate-400 pointer-events-none"><i class="fa-solid fa-chevron-down text-xs"></i></div>
                        </div>
                    </div>

                    <div id="custom-prompt-container" class="hidden">
                        <input type="text" id="custom-prompt-input" placeholder="e.g. Speak like a pirate..." class="w-full h-10 rounded-lg bg-slate-800 border border-slate-600 text-white text-sm px-3 outline-none focus:border-sky-500">
                    </div>
                    
                    <div class="text-right"><button onclick="toggleDebug()" class="text-[10px] text-slate-500 hover:text-white underline">Lihat Prompt Asli</button></div>
                    <div id="debug-container" class="hidden mt-2 p-3 bg-black/40 rounded-lg border border-slate-700">
                        <textarea id="debug-prompt" readonly class="w-full h-16 bg-transparent text-[10px] text-green-400 font-mono resize-none outline-none"></textarea>
                    </div>
                </div>

                <div id="standard-controls" class="hidden grid grid-cols-2 gap-4 pt-2">
                    <div class="bg-slate-800/50 p-3 rounded-xl border border-slate-700">
                        <div class="flex justify-between mb-2"><label class="text-[10px] font-bold text-slate-400 uppercase">Kecepatan</label><span id="rate-val" class="text-[10px] text-sky-400 font-mono">1.0</span></div>
                        <input type="range" id="rate" min="0.5" max="2" value="1" step="0.1" class="range-slider" oninput="document.getElementById('rate-val').innerText = this.value">
                    </div>
                    <div class="bg-slate-800/50 p-3 rounded-xl border border-slate-700">
                        <div class="flex justify-between mb-2"><label class="text-[10px] font-bold text-slate-400 uppercase">Nada</label><span id="pitch-val" class="text-[10px] text-sky-400 font-mono">1.0</span></div>
                        <input type="range" id="pitch" min="0" max="2" value="1" step="0.1" class="range-slider" oninput="document.getElementById('pitch-val').innerText = this.value">
                    </div>
                </div>

                <button id="speak-btn" class="w-full bg-gradient-to-r from-sky-600 to-blue-600 hover:from-sky-500 hover:to-blue-500 text-white font-bold py-3.5 px-6 rounded-xl shadow-lg shadow-sky-900/40 transition-all active:scale-[0.98] flex justify-center items-center gap-2 group">
                    <i class="fa-solid fa-play group-hover:scale-110 transition-transform"></i> Generate & Play
                </button>
            </div>
            
            <div id="history-container" class="hidden mt-4">
                <h3 class="text-xs font-bold text-slate-400 uppercase mb-3 flex items-center gap-2 ml-1"><i class="fa-solid fa-clock-rotate-left"></i> Riwayat & Download</h3>
                <div id="history-list" class="space-y-2"></div
